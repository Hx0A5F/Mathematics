!function(t){"use strict";Number.prototype.Stringify=function(){return this.toString()},Number.prototype.Generalize=function(){return this};var e={Add:function(t,r){return t=e.isComplex(r)&&!e.isComplex(t)?e.Complex(t,0):t,r=e.isComplex(t)&&!e.isComplex(r)?e.Complex(r,0):r,e.isComplex(t)?t.Add(r).Generalize():t+r},Subtract:function(t,r){return t=e.isComplex(r)&&!e.isComplex(t)?e.Complex(t,0):t,r=e.isComplex(t)&&!e.isComplex(r)?e.Complex(r,0):r,e.isComplex(t)?t.Subtract(r).Generalize():t-r},Multiply:function(t,r){return t=e.isComplex(r)&&!e.isComplex(t)?e.Complex(t,0):t,r=e.isComplex(t)&&!e.isComplex(r)?e.Complex(r,0):r,e.isComplex(t)?t.Multiply(r).Generalize():t*r},Divide:function(t,r){return t=e.isComplex(r)&&!e.isComplex(t)?e.Complex(t,0):t,r=e.isComplex(t)&&!e.isComplex(r)?e.Complex(r,0):r,e.isComplex(t)?t.Divide(r).Generalize():t/r},Power:function(t,r){return e.isComplex(t)||e.isComplex(r)?e.Exp(e.Multiply(r,e.Ln(t))).Generalize():Math.pow(t,r)},Tetration:function(t,r){if(e.isInteger(r)){for(var i=t,n=0;r-1>n;n++)i=e.Power(t,i);return r>0?i:0==r?1:-1==r?0:void 0}return void 0},Root:function(t,r){return r||(r=2),e.Power(t,e.Divide(1,r))},Square:function(t){return e.Power(t,2)},Cube:function(t){return e.Power(t,3)},Abs:function(t){return e.isComplex(t)?e.Distance([t.RealPart(),t.ImaginaryPart()],[0,0]):Math.abs(t)},Sign:function(t){return 0==t?t:e.Divide(t,e.Abs(t))},Floor:function(t){return e.isComplex(t)?e.Complex(e.Floor(t.RealPart()),e.Floor(t.ImaginaryPart())).Generalize():Math.floor(t)},Ceil:function(t){return e.isComplex(t)?e.Complex(e.Ceil(t.RealPart()),e.Ceil(t.ImaginaryPart())).Generalize():Math.ceil(t)},Round:function(t){return e.isComplex(t)?e.Complex(e.Round(t.RealPart()),e.Round(t.ImaginaryPart())).Generalize():Math.round(t)},GCD:function(t,r){return t=e.Abs(t),r=e.Abs(r),r>t?e.GCD(r,t):t%r==0?r:e.GCD(r,t%r)},LCM:function(t,r){return t*r/e.GCD(t,r)},Sin:function(t){return e.isComplex(t)?e.Complex(e.Multiply(e.Sin(t.RealPart()),e.Cosh(t.ImaginaryPart())),e.Multiply(e.Cos(t.RealPart()),e.Sinh(t.ImaginaryPart()))).Generalize():Math.sin(t)},Cos:function(t){return e.isComplex(t)?e.Complex(e.Multiply(e.Cos(t.RealPart()),e.Cosh(t.ImaginaryPart())),e.Multiply(e.Sin(t.RealPart()),e.Sinh(t.ImaginaryPart()))).Conjugate().Generalize():Math.cos(t)},Tan:function(t){return e.Divide(e.Sin(t),e.Cos(t)).Generalize()},Sec:function(t){return e.Divide(1,e.Cos(t)).Generalize()},Csc:function(t){return e.Divide(1,e.Sin(t)).Generalize()},Cot:function(t){return e.Divide(1,e.Tan(t)).Generalize()},Arcsin:function(t){return t=e.isComplex(t)?t:e.Complex(t,0),e.Complex(0,1).Multiply(e.Arcsinh(e.Complex(t.ImaginaryPart(),-t.RealPart()))).Generalize()},Arccos:function(t){return e.Subtract(e.PI/2,e.Arcsin(t)).Generalize()},Arctan:function(t){return e.Arcsin(e.Divide(t,e.Root(e.Add(e.Square(t),1)))).Generalize()},Arcsec:function(t){return e.Arccos(e.Divide(1,t)).Generalize()},Arccsc:function(t){return e.Arcsin(e.Divide(1,t)).Generalize()},Arccot:function(t){return e.Arctan(e.Divide(1,t)).Generalize()},Sinh:function(t){return e.Divide(e.Subtract(e.Exp(t),e.Exp(e.Multiply(t,-1))),2).Generalize()},Cosh:function(t){return e.Divide(e.Add(e.Exp(t),e.Exp(e.Multiply(t,-1))),2).Generalize()},Tanh:function(t){return e.Divide(e.Sinh(t),e.Cosh(t)).Generalize()},Sech:function(t){return e.Divide(1,e.Cosh(t)).Generalize()},Csch:function(t){return e.Divide(1,e.Sinh(t)).Generalize()},Coth:function(t){return e.Divide(1,e.Tanh(t)).Generalize()},Arcsinh:function(t){return e.Ln(e.Add(t,e.Root(e.Add(e.Square(t),1)))).Generalize()},Arccosh:function(t){return e.Ln(e.Add(t,e.Root(e.Subtract(e.Square(t),1)))).Generalize()},Arctanh:function(t){return e.Divide(e.Ln(e.Divide(e.Add(1,t),e.Subtract(1,t))),2).Generalize()},Arcsech:function(t){return e.Arccosh(e.Divide(1,t)).Generalize()},Arccsch:function(t){return e.Arcsinh(e.Divide(1,t)).Generalize()},Arccoth:function(t){return e.Arctanh(e.Divide(1,t)).Generalize()},Exp:function(t){return e.isComplex(t)?e.Complex(e.Exp(t.RealPart())*e.Cos(t.ImaginaryPart()),e.Exp(t.RealPart())*e.Sin(t.ImaginaryPart())).Generalize():Math.exp(t)},Log:function(t){return e.isComplex(t)?e.Ln(t).Divide(e.Complex(e.Ln(10),0)).Generalize():Math.log(t)/Math.log(10)},Lb:function(t){return e.isComplex(t)?e.Ln(t).Divide(e.Complex(e.Ln(2),0)).Generalize():Math.log(t)/Math.log(2)},Ln:function(t){return e.isComplex(t)?e.Complex(e.Ln(e.Abs(t)),Math.atan2(t.ImaginaryPart(),t.RealPart())).Generalize():0>t?e.Complex(e.Ln(-t),e.PI):Math.log(t)},AP:function(t,e){return function(r){return t+(r-1)*e}},GP:function(t,r){return function(){return t*e.Power(t,r-1)}},HP:function(t,r){return function(i){return 1/e.AP(t,r)(i)}},Fibonacci:function(t){return e.Round(1/e.Root(5)*(e.Power((1+e.Root(5))/2,t)-e.Power((1-e.Root(5))/2,t)))},Sum:function(t,r,i){for(var n=e.Complex(0,0),a=t;r>=a;a++)if(1/0==e.Abs(r)){if(n.Stringify()==e.Add(n,i(a)).Stringify())break;n=e.Add(n,i(a))}else n=e.Add(n,i(a));return n.Generalize()},Product:function(t,r,i){for(var n=e.Complex(1,0),a=t;r>=a;a++)if(1/0==e.Abs(r)){if(n.Stringify()==e.Multiply(n,i(a)).Stringify())break;n=e.Multiply(n,i(a))}else n=e.Multiply(n,i(a));return n.Generalize()},Sinc:function(t){return t=e.isComplex(t)&&t.Realize?t.Realize():t,0==t?1:e.Divide(e.Sin(t),t).Generalize()},Zeta:function(t){return t>1?1/0==t?1:e.Sum(1,1/0,function(r){return e.Divide(1,e.Power(r,t))}).Generalize():void 0},Gamma:function(t){return e.isInteger(t)?e.Product(1,e.Subtract(t,1),function(t){return t}):e.Divide(e.Product(1,1/0,function(r){return e.Divide(e.Power(e.Add(1,e.Divide(1,r)),t),e.Add(1,e.Divide(t,r)))}),t).Generalize()},Factorial:function(t){return e.Gamma(e.Add(t,1))},Random:function(t){return e.Round(e.Multiply(Math.random(),t))},isInteger:function(t){return e.isComplex(t)?t.Realize instanceof Function&&t.Realize()%1==0:t%1==0},isComplex:function(t){return t.RealPart instanceof Function&&t.ImaginaryPart instanceof Function},isCoprime:function(t,r){return t=e.isInteger(t)&&e.isComplex(t)?t.Realize():t,r=e.isInteger(r)&&e.isComplex(r)?r.Realize():r,e.isInteger(t)&&e.isInteger(r)&&1==e.GCD(t,r)},Radian:function(t){return t/180*e.PI},Degree:function(t){return 180*t/e.PI},Distance:function(t,r){return e.Root(e.Square(e.Subtract(r[0],t[0]))+e.Square(e.Subtract(r[1],t[1]))).Generalize()},Midpoint:function(t,r){return[e.Divide(e.Add(r[0],t[0]),2).Generalize(),e.Divide(e.Add(r[1],t[1]),2).Generalize()]},Matrix:function(t){var r=function(t){var r=t,i=t.length,n=t[0].length?t[0].length:1;this.Rows=i,this.Columns=n,this.Item=function(t,e){return t>0&&e>0?r[t-1][e-1]:void 0},this.RowVector=function(t){return e.Vector(r[t-1])},this.ColumnVector=function(t){for(var r=[],n=1;i>=n;n++)r.push([this.Item(n,t)]);return e.Vector(r.Transpose().RowVector(1))},this.ScalarMultiply=function(t){for(var a=[],u=0;i>u;u++){a[u]=[];for(var o=0;n>o;o++)a[u].push(e.Multiply(r[u][o],t).Generalize())}return e.Matrix(a)},this.Transpose=function(){for(var t=[],a=0;n>a;a++){t[a]=[];for(var u=0;i>u;u++)t[a][u]=r[u][a]}return e.Matrix(t)},this.Add=function(t){for(var r=[],a=0;i>a;a++){r[a]=[];for(var u=1;n>=u;u++)r[a].push(e.Add(this.Item(a+1,u),t.Item(a+1,u)))}return e.Matrix(r)},this.Subtract=function(t){return this.Add(t.ScalarMultiply(-1))},this.Multiply=function(t){if(n==t.Rows){for(var r=[],a=t.Transpose(),u=0;i>u;u++){r[u]=[];for(var o=0;o<t.Columns;o++){r[u][o]=0;for(var l=1;n>=l;l++)r[u][o]=e.Add(r[u][o],e.Multiply(this.Item(u+1,l),a.Item(o+1,l)))}}return e.Matrix(r)}},n==i&&(this.Adjugate=function(){for(var t=[],r=1;i>=r;r++){t.push([]);for(var a=1;n>=a;a++)t[t.length-1].push(this.Cofactor(r,a))}return e.Matrix(t).Transpose()},this.Minor=function(t,r){for(var a=[],u=0;i>u;u++)if(u!=t-1){a.push([]);for(var o=1;n>=o;o++)o!=r&&a[a.length-1].push(this.Item(u+1,o))}return e.Matrix(a).Determinant()},this.Cofactor=function(t,r){return e.Multiply(e.Power(-1,t+r),this.Minor(t,r))},this.Trace=function(){for(var t=0,r=1;i>=r;r++)t=e.Add(t,this.Item(r,r));return t.Generalize()},this.Determinant=function(){return 1==i?this.Item(1,1).Generalize():e.Sum(1,i,function(t){return function(r){return e.Multiply(t.Item(r,1),t.Cofactor(r,1))}}(this))},0!=this.Determinant()&&(this.InverseMatrix=function(){return this.Adjugate().ScalarMultiply(e.Divide(1,this.Determinant()))})),(1==n||1==i)&&(this.Serialize=function(){if(1==n)return this.Transpose().Serialize();for(var t=[],e=1;n>=e;e++)t.push(this.Item(1,e));return t}),this.Stringify=function(){for(var t="[",e=1;i>=e;e++){t+=1==e?"":" ";for(var r=1;n>=r;r++)t+=this.Item(e,r).Stringify()+(e==i&&r==n?"":", ");t+=e==i?"]":"\n"}return t}};return new r(t)},Complex:function(t,r){var i=function(t,r){var i=t,n=r;this.RealPart=function(){return i},this.ImaginaryPart=function(){return n},0==n&&(this.Realize=function(){return Number(i)}),this.Generalize=function(){return this.Realize?this.Realize():this},this.Add=function(t){return e.Complex(i+t.RealPart(),n+t.ImaginaryPart())},this.Subtract=function(t){return e.Complex(i-t.RealPart(),n-t.ImaginaryPart())},this.Multiply=function(t){return e.Complex(i*t.RealPart()-n*t.ImaginaryPart(),i*t.ImaginaryPart()+n*t.RealPart())},this.Divide=function(t){return e.Complex((i*t.RealPart()+n*t.ImaginaryPart())/(e.Square(t.RealPart())+e.Square(t.ImaginaryPart())),(n*t.RealPart()-i*t.ImaginaryPart())/(e.Square(t.RealPart())+e.Square(t.ImaginaryPart())))},this.Conjugate=function(){return e.Complex(i,-n)},this.Stringify=function(){return i.toString()+" + "+n.toString()+"i"}};return new i(t,r)},RotateTransform:function(t,r){return e.Matrix([[e.Cos(t),-e.Sin(t)],[e.Sin(t),e.Cos(t)]]).Multiply(e.Matrix([[r[0]],[r[1]]])).ColumnVector(1).Serialize()},Permutation:function(t,r){return e.Divide(e.Factorial(t),e.Factorial(e.Subtract(t,r)))},RepeatedPermutation:function(t,r){return e.Power(t,r)},Combination:function(t,r){return e.Divide(e.Permutation(t,r),e.Factorial(r))},RepeatedCombination:function(t,r){return e.Combination(e.Subtract(e.Add(t,r),1),r)},Vector:function(t){var r=function(r){var r=e.Matrix([t]);this.Matrix=function(){return e.Matrix([r.Serialize()])},this.Item=function(t){return r.Item(1,t)},this.Length=function(){for(var t=0,i=1;i<=r.Columns;i++)t=e.Add(t,e.Square(r.Item(1,i)));return e.Root(t)},this.Add=function(t){return e.Vector(r.Add(t.Matrix()).Serialize())},this.Subtract=function(t){return this.Add(t.ScalarMultiply(-1))},this.InnerProduct=this.ScalarProduct=this.DotProduct=function(t){return r.Transpose().Multiply(t.Matrix()).Trace()},(3==r.Columns||7==r.Columns)&&(this.OuterProduct=this.VectorProduct=this.CrossProduct=function(t){return 3==r.Columns?e.Vector([e.Subtract(e.Multiply(r.Item(1,2),t.Matrix().Item(1,3)),e.Multiply(r.Item(1,3),t.Matrix().Item(1,2))),e.Subtract(e.Multiply(r.Item(1,3),t.Matrix().Item(1,1)),e.Multiply(r.Item(1,1),t.Matrix().Item(1,3))),e.Subtract(e.Multiply(r.Item(1,1),t.Matrix().Item(1,2)),e.Multiply(r.Item(1,2),t.Matrix().Item(1,1)))]):e.Vector([e.Subtract(e.Add(e.Add(e.Multiply(r.Item(1,2),t.Matrix().Item(1,3)),e.Multiply(r.Item(1,4),t.Matrix().Item(1,5))),e.Multiply(r.Item(1,7),t.Matrix().Item(1,6))),e.Add(e.Add(e.Multiply(r.Item(1,3),t.Matrix().Item(1,2)),e.Multiply(r.Item(1,5),t.Matrix().Item(1,4))),e.Multiply(r.Item(1,6),t.Matrix().Item(1,7)))),e.Subtract(e.Add(e.Add(e.Multiply(r.Item(1,3),t.Matrix().Item(1,1)),e.Multiply(r.Item(1,4),t.Matrix().Item(1,6))),e.Multiply(r.Item(1,5),t.Matrix().Item(1,7))),e.Add(e.Add(e.Multiply(r.Item(1,1),t.Matrix().Item(1,3)),e.Multiply(r.Item(1,6),t.Matrix().Item(1,4))),e.Multiply(r.Item(1,7),t.Matrix().Item(1,5)))),e.Subtract(e.Add(e.Add(e.Multiply(r.Item(1,1),t.Matrix().Item(1,2)),e.Multiply(r.Item(1,2),t.Matrix().Item(1,1))),e.Multiply(r.Item(1,4),t.Matrix().Item(1,7))),e.Add(e.Add(e.Multiply(r.Item(1,5),t.Matrix().Item(1,6)),e.Multiply(r.Item(1,6),t.Matrix().Item(1,5))),e.Multiply(r.Item(1,7),t.Matrix().Item(1,4)))),e.Subtract(e.Add(e.Add(e.Multiply(r.Item(1,5),t.Matrix().Item(1,1)),e.Multiply(r.Item(1,6),t.Matrix().Item(1,2))),e.Multiply(r.Item(1,7),t.Matrix().Item(1,3))),e.Add(e.Add(e.Multiply(r.Item(1,1),t.Matrix().Item(1,5)),e.Multiply(r.Item(1,2),t.Matrix().Item(1,6))),e.Multiply(r.Item(1,3),t.Matrix().Item(1,7)))),e.Subtract(e.Add(e.Add(e.Multiply(r.Item(1,1),t.Matrix().Item(1,4)),e.Multiply(r.Item(1,2),t.Matrix().Item(1,7))),e.Add(e.Multiply(r.Item(1,3),t.Matrix().Item(1,6)),e.Multiply(r.Item(1,4),t.Matrix().Item(1,1)))),e.Add(e.Multiply(r.Item(1,6),t.Matrix().Item(1,3)),e.Multiply(r.Item(1,7),t.Matrix().Item(1,2)))),e.Subtract(e.Add(e.Add(e.Multiply(r.Item(1,1),t.Matrix().Item(1,7)),e.Multiply(r.Item(1,2),t.Matrix().Item(1,4))),e.Add(e.Multiply(r.Item(1,3),t.Matrix().Item(1,5)),e.Multiply(r.Item(1,4),t.Matrix().Item(1,2)))),e.Add(e.Multiply(r.Item(1,5),t.Matrix().Item(1,3)),e.Multiply(r.Item(1,7),t.Matrix().Item(1,1)))),e.Subtract(e.Add(e.Add(e.Multiply(r.Item(1,4),t.Matrix().Item(1,3)),e.Multiply(r.Item(1,1),t.Matrix().Item(1,6))),e.Add(e.Multiply(r.Item(1,3),t.Matrix().Item(1,4)),e.Multiply(r.Item(1,2),t.Matrix().Item(1,5)))),e.Add(e.Multiply(r.Item(1,6),t.Matrix().Item(1,1)),e.Multiply(r.Item(1,5),t.Matrix().Item(1,2))))])}),this.ScalarMultiply=function(t){return e.Vector(this.Matrix().ScalarMultiply(t).Serialize())},this.Serialize=function(){return r.Serialize()},this.Stringify=function(){return r.Stringify()}};return new r(t)}};e.E=e.Sum(0,1/0,function(t){return 1/e.Factorial(t)}),e.PI=e.Sum(0,1/0,function(t){return e.Power(16,-t)*(4/(8*t+1)-2/(8*t+4)-1/(8*t+5)-1/(8*t+6))}),e.PHI=(1+e.Root(5))/2,e.Matrix.Identity=function(t){for(var r=[],i=0;t>i;i++){r[i]=[];for(var n=0;t>n;n++)r[i][n]=i==n?1:0}return e.Matrix(r)},e.Matrix.Zero=function(t){for(var r=[],i=0;t>i;i++){r[i]=[];for(var n=0;t>n;n++)r[i][n]=0}return e.Matrix(r)},t.Mathematics=e}(self);